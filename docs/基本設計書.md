# ブックマークマネージャ v2 - 基本設計書

## 1. システム概要

### 1.1 システム名称
ブックマークマネージャ v2

### 1.2 システム目的
ユーザーが効率的にブックマークを管理できるWebアプリケーションを提供する。
複数のカラムによる階層的な表示と、直感的な操作で高い生産性を実現する。

### 1.3 対象ユーザー
- Webブラウザを日常的に使用するユーザー
- 多数のブックマークを効率的に管理したいユーザー
- カテゴリー別にブックマークを整理したいユーザー

### 1.4 システム特徴
- マルチカラム表示による見やすい管理画面
- ドラッグ&ドロップによる直感的な操作
- フォルダによる階層的な分類
- お気に入り機能による重要サイトの素早いアクセス
- Chromeブックマークからのインポート機能

## 2. システム構成

### 2.1 技術スタック
- **フロントエンド**: HTML5, CSS3, JavaScript (ES6+)
- **データ保存**: localStorage (ブラウザ内蔵)
- **外部ライブラリ**:
  - SortableJS: ドラッグ&ドロップ機能
  - Micromodal.js: モーダルウィンドウ
  - Vanilla Picker: カラーピッカー
  - Font Awesome: アイコン表示

### 2.2 ファイル構成
```
bookmark_manager_with_claude/
├── index.html              # メインHTMLファイル
├── script.js               # メインJavaScriptファイル
├── style.css               # スタイルシート
├── 設計書.txt              # 初期設計文書（日本語）
├── sample_bookmarks_v2.json # サンプルデータ
└── docs/                   # 設計文書フォルダ
    ├── 基本設計書.md
    └── 詳細設計書.md
```

## 3. 機能概要

### 3.1 主要機能一覧

| 機能分類 | 機能名 | 概要 |
|---------|-------|------|
| カラム管理 | カラム追加 | 新しいカラムを追加する |
| | カラム削除 | 既存のカラムを削除する |
| | カラムリサイズ | カラムの幅を調整する |
| | カラム移動 | カラムの順序を変更する |
| ブックマーク管理 | ブックマーク追加 | 新しいブックマークを作成する |
| | ブックマーク編集 | 既存のブックマークを編集する |
| | ブックマーク削除 | ブックマークを削除する |
| | ブックマーク移動 | ドラッグ&ドロップで移動する |
| フォルダ管理 | フォルダ作成 | 新しいフォルダを作成する |
| | フォルダ編集 | フォルダ名や色を編集する |
| | フォルダ削除 | フォルダとその中身を削除する |
| | フォルダ展開/折りたたみ | フォルダの表示切り替え |
| お気に入り | お気に入り追加/削除 | ブックマークをお気に入りに登録 |
| | お気に入り表示 | 上部バーにお気に入りを表示 |
| | お気に入り並び替え | お気に入りの順序を変更 |
| データ管理 | エクスポート | データをJSONファイルで保存 |
| | インポート | JSONファイルからデータを読み込み |
| | Chromeインポート | ChromeブックマークHTMLを読み込み |
| | 自動保存 | 変更時にlocalStorageへ自動保存 |
| ユーザビリティ | アイコン選択 | ブックマークアイコンをGUIで選択 |
| | カラーピッカー | フォルダ背景色を視覚的に選択 |
| | コンテキストメニュー | 右クリックで操作メニュー表示 |
| | ヘルプ機能 | 使い方ガイドを表示 |

### 3.2 ユーザーインターフェース構成

```
┌─────────────────────────────────────────────────────┐
│ ヘッダー                                            │
│ ┌─────────────────┐ ┌─────────────────────────────┐ │
│ │ お気に入りバー   │ │ 操作ボタン群                │ │
│ │ (ドラッグ可能)   │ │ (エクスポート/インポート等) │ │
│ └─────────────────┘ └─────────────────────────────┘ │
├─────────────────────────────────────────────────────┤
│ メインコンテンツエリア                               │
│ ┌────────┐ ┌────────┐ ┌────────┐                  │
│ │カラム1  │ │カラム2  │ │カラム3  │ ...            │
│ │┌──────┐│ │┌──────┐│ │┌──────┐│                  │
│ ││フォルダ││ ││ブック││ ││フォルダ││                  │
│ ││ └──┐ ││ ││マーク││ ││ └──┐ ││                  │
│ ││   ├─││ │└──────┘│ ││   ├─││                  │
│ ││   └─││ │┌──────┐│ ││   └─││                  │
│ │└──────┘│ ││ブック││ │└──────┘│                  │
│ │        │ ││マーク││ │        │                  │
│ │        │ │└──────┘│ │        │                  │
│ └────────┘ └────────┘ └────────┘                  │
│                                      ┌─────────┐  │
│                                      │  +      │  │
│                                      │(カラム  │  │
│                                      │ 追加)   │  │
│                                      └─────────┘  │
└─────────────────────────────────────────────────────┘
```

## 4. データ構造

### 4.1 アプリケーションデータ構造
```javascript
{
  appSettings: {},           // アプリケーション設定
  columns: [                 // カラム配列
    {
      id: "uuid",           // 一意識別子
      width: "300px",       // カラム幅
      createdAt: "ISO日時", // 作成日時
      updatedAt: "ISO日時", // 更新日時
      items: [...]          // アイテム配列
    }
  ],
  columnOrder: ["uuid1", "uuid2"], // カラム表示順序
  favoritesOrder: ["uuid1", "uuid2"] // お気に入り順序
}
```

### 4.2 アイテムデータ構造

#### ブックマーク
```javascript
{
  id: "uuid",              // 一意識別子
  type: "bookmark",        // アイテムタイプ
  title: "サイト名",       // 表示名
  url: "https://...",      // URL
  icon: "fas fa-bookmark", // FontAwesome アイコン
  isFavorite: false,       // お気に入りフラグ
  createdAt: "ISO日時",    // 作成日時
  updatedAt: "ISO日時"     // 更新日時
}
```

#### フォルダ
```javascript
{
  id: "uuid",              // 一意識別子
  type: "folder",          // アイテムタイプ
  title: "フォルダ名",     // 表示名
  color: "#e3f2fd",        // 背景色
  collapsed: false,        // 折りたたみ状態
  createdAt: "ISO日時",    // 作成日時
  updatedAt: "ISO日時",    // 更新日時
  children: [...]          // 子アイテム配列
}
```

## 5. 外部連携

### 5.1 Chromeブックマークインポート
- **形式**: Chrome HTMLエクスポートファイル
- **処理方法**: DOMParserを使用したHTML解析
- **対応要素**: `<DT>`, `<DL>`, `<H3>`, `<A>`タグ
- **生成結果**: 新規カラムとしてインポート

### 5.2 データエクスポート・インポート
- **形式**: JSON形式
- **内容**: 全アプリケーションデータ
- **用途**: バックアップ、データ移行、複数環境間でのデータ共有

## 6. ユーザビリティ設計

### 6.1 操作方法
- **主操作**: 右クリックによるコンテキストメニュー
- **副操作**: ドラッグ&ドロップによる移動操作
- **視覚フィードバック**: ホバー効果、ドラッグ中の視覚的変化
- **状態保持**: カラム幅、フォルダ展開状態の永続化

### 6.2 レスポンシブ対応
- **デスクトップ**: 3カラム以上の横並び表示
- **タブレット**: 2カラム表示、横スクロール
- **モバイル**: 1カラム表示、完全な縦スクロール

### 6.3 アクセシビリティ
- **キーボード操作**: モーダル内でのTab移動
- **スクリーンリーダー**: aria-label等の適切な属性設定
- **カラーコントラスト**: 視認性を考慮した配色

## 7. パフォーマンス設計

### 7.1 データ管理
- **保存方式**: 変更時の即座なlocalStorage保存
- **読み込み**: ページロード時の一括読み込み
- **メモリ使用**: 単一オブジェクトでの状態管理

### 7.2 描画最適化
- **再描画範囲**: 必要最小限の要素のみ更新
- **イベント処理**: Event Delegationによる効率的なイベント管理
- **ライブラリ**: CDNからの軽量ライブラリ利用

## 8. セキュリティ

### 8.1 データ保護
- **保存場所**: ブラウザ内localStorage（ローカル環境のみ）
- **外部送信**: なし（完全なクライアントサイドアプリケーション）
- **入力検証**: URL形式の検証、XSS対策

### 8.2 制限事項
- **同一オリジン**: 同じドメイン・ポート・プロトコルでのみデータ共有
- **ストレージ容量**: ブラウザのlocalStorage制限に依存
- **データ永続性**: ユーザーによるブラウザデータ削除で消失の可能性